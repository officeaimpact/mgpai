# TourVisor XML API - Документация

Документация по работе с XML API сервиса TourVisor.ru для поиска и бронирования туров.

## Обзор API

TourVisor предоставляет XML/JSON API для:
- Поиска туров по заданным параметрам
- Получения справочников (страны, города, отели, типы питания и т.д.)
- Актуализации цен и проверки наличия мест
- Получения описаний и фотографий отелей
- Работы с горящими турами

## Структура документации

### 1. XML - поиск туров/

| Файл | Описание | Когда использовать |
|------|----------|-------------------|
| **1. Поиск туров.md** | Основной поисковый шлюз. Параметры запроса (даты, страна, курорт, ночи, туристы), структура ответа (отели, туры, цены), механизм пагинации и продолжения поиска. | При реализации поиска туров. Это основной файл для интеграции поискового функционала. |
| **2. Справочники.md** | Получение справочных данных: города вылета, страны, курорты, отели, операторы, типы питания, звёздность, услуги. | При инициализации приложения для загрузки справочников. При построении фильтров и выпадающих списков. |
| **3. Актуализация.md** | Проверка актуальной цены тура в системе туроператора. Получение детальной информации по конкретному туру. | Перед оформлением заказа - для проверки, что цена и наличие мест актуальны. |
| **4. Актуализация детальная.md** | Расширенная актуализация с информацией об авиарейсах (компания, время вылета/прилёта, аэропорты), платежах, содержимом тура. | Когда нужны детали по перелётам. При отображении полной информации о туре перед бронированием. |

### 2. XML - описания/

| Файл | Описание | Когда использовать |
|------|----------|-------------------|
| **1. Описания отелей.md** | Получение полной информации об отеле: описание, фотографии, отзывы, координаты, рейтинг, инфраструктура, типы номеров. | При отображении страницы отеля. Для показа фотографий и отзывов в результатах поиска. |

### 3. XML - горящие туры/

| Файл | Описание | Когда использовать |
|------|----------|-------------------|
| **1. Горящие туры.md** | Получение списка горящих (спецпредложений) туров с фильтрами по городу, стране, датам, звёздности, рейтингу, питанию. | Для раздела "Горящие туры" или "Спецпредложения". Для виджетов с выгодными предложениями на главной странице. |

## Авторизация

Все запросы к API требуют авторизации одним из способов:

1. **Логин/пароль:**
   ```
   authlogin=ваш_логин&authpass=ваш_пароль
   ```

2. **Ключ авторизации:**
   ```
   authkey=ваш_ключ
   ```

## Форматы ответа

API поддерживает два формата:
- `format=xml` (по умолчанию)
- `format=json`

## Базовые URL

- Поиск: `http://tourvisor.ru/xml/search.php`
- Результаты: `http://tourvisor.ru/xml/result.php`
- Справочники: `http://tourvisor.ru/xml/list.php`
- Актуализация: `http://tourvisor.ru/xml/actualize.php`
- Детальная актуализация: `http://tourvisor.ru/xml/actdetail.php`
- Описания отелей: `http://tourvisor.ru/xml/hotel.php`
- Горящие туры: `http://tourvisor.ru/xml/hottours.php`

## Важные замечания

1. **Лимиты запросов** - существует суточный лимит на количество запросов. При превышении взимается дополнительная плата.

2. **IP-привязка** - результаты поиска можно получить только с того же IP, с которого был инициирован поиск.

3. **Актуальность tourid** - идентификатор тура (tourid) действителен ограниченное время, не используйте его для долговременного хранения.

4. **Кодировка** - все ответы в UTF-8.

## Типичный flow работы с API

```
1. Загрузить справочники (list.php)
   ↓
2. Пользователь выбирает параметры поиска
   ↓
3. Создать поисковый запрос (search.php)
   ↓
4. Через 3-7 сек получить результаты (result.php)
   ↓
5. Пользователь выбирает тур
   ↓
6. Актуализировать цену (actualize.php)
   ↓
7. Показать детали перелёта (actdetail.php)
   ↓
8. Оформить заказ
```
